<div class="search-container">
  <!-- Search Bar -->
  <mat-card class="search-card">
    <mat-card-content>
      <mat-form-field class="search-field" appearance="outline">
        <mat-label>Search</mat-label>
        <input 
          matInput 
          placeholder="Search by name, email, or status..."
          [ngModel]="searchText()"
          (ngModelChange)="onSearchChange($event)">
        <mat-icon matPrefix>search</mat-icon>
        @if (searchText()) {
          <button 
            matSuffix 
            mat-icon-button 
            (click)="onSearchChange('')">
            <mat-icon>close</mat-icon>
          </button>
        }
      </mat-form-field>
    </mat-card-content>
  </mat-card>

  <!-- Table -->
  <mat-card class="table-card">
    @if (loading()) {
      <div class="loading-container">
        <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
      </div>
    } @else {
      <div class="table-container">
        <table mat-table [dataSource]="displayedData()" class="data-table">
          
          <!-- ID Column -->
          <ng-container matColumnDef="id">
            <th mat-header-cell *matHeaderCellDef>ID</th>
            <td mat-cell *matCellDef="let item">{{ item.id }}</td>
          </ng-container>

          <!-- Name Column -->
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let item">{{ item.name }}</td>
          </ng-container>

          <!-- Email Column -->
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let item">{{ item.email }}</td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let item">
              <span class="status-badge" [class]="'status-' + item.status.toLowerCase()">
                {{ item.status }}
              </span>
            </td>
          </ng-container>

          <!-- Created Date Column -->
          <ng-container matColumnDef="createdDate">
            <th mat-header-cell *matHeaderCellDef>Created Date</th>
            <td mat-cell *matCellDef="let item">{{ item.createdDate }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr 
            mat-row 
            *matRowDef="let row; columns: displayedColumns;"
            class="clickable-row"
            (click)="onRowClick(row)">
          </tr>
        </table>

        <!-- Paginator -->
        <mat-paginator
          [length]="totalItems()"
          [pageSize]="pageSize()"
          [pageIndex]="pageIndex()"
          [pageSizeOptions]="[5, 10, 25, 50]"
          (page)="onPageChange($event)"
          showFirstLastButtons>
        </mat-paginator>
      </div>
    }
  </mat-card>

  <!-- Detail View Modal -->
  @if (selectedItem()) {
    <div class="detail-overlay" (click)="closeDetail()">
      <mat-card class="detail-card" (click)="$event.stopPropagation()">
        <mat-card-header>
          <mat-card-title>Item Details</mat-card-title>
          <button mat-icon-button (click)="closeDetail()" class="close-btn">
            <mat-icon>close</mat-icon>
          </button>
        </mat-card-header>
        
        <mat-card-content>
          <div class="detail-row">
            <span class="detail-label">ID:</span>
            <span class="detail-value">{{ selectedItem()!.id }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Name:</span>
            <span class="detail-value">{{ selectedItem()!.name }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Email:</span>
            <span class="detail-value">{{ selectedItem()!.email }}</span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Status:</span>
            <span class="status-badge" [class]="'status-' + selectedItem()!.status.toLowerCase()">
              {{ selectedItem()!.status }}
            </span>
          </div>
          <div class="detail-row">
            <span class="detail-label">Created Date:</span>
            <span class="detail-value">{{ selectedItem()!.createdDate }}</span>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>