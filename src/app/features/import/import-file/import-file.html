<div class="upload-container">
  <mat-card class="upload-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>upload_file</mat-icon>
        Upload Excel File
      </mat-card-title>
    </mat-card-header>

    <mat-card-content>
      <!-- Hidden file input -->
      <input
        type="file"
        id="fileInput"
        accept=".xlsx,.xls"
        (change)="onFileSelected($event)"
        style="display: none;"
      />

      <!-- Upload Area -->
      <div class="upload-area" [class.has-file]="selectedFile()">
        @if (!selectedFile()) {
          <!-- Empty State -->
          <div class="upload-prompt">
            <mat-icon class="upload-icon">cloud_upload</mat-icon>
            <h3>Drop your Excel file here</h3>
            <p>or</p>
            <button 
              mat-raised-button 
              color="primary" 
              (click)="triggerFileInput()"
              class="select-file-btn">
              <mat-icon>folder_open</mat-icon>
              Select File
            </button>
            <p class="file-info">Supported formats: XLSX, XLS (Max 50MB)</p>
          </div>
        } @else {
          <!-- File Selected State -->
          <div class="file-selected">
            <div class="file-details">
              <mat-icon class="file-icon">description</mat-icon>
              <div class="file-info-details">
                <h4>{{ selectedFile()!.name }}</h4>
                <p>{{ formatFileSize(selectedFile()!.size) }}</p>
              </div>
              <button 
                mat-icon-button 
                color="warn" 
                (click)="removeFile()"
                [disabled]="uploading()">
                <mat-icon>close</mat-icon>
              </button>
            </div>

            @if (uploading()) {
              <div class="upload-progress">
                <mat-progress-bar 
                  mode="determinate" 
                  [value]="uploadProgress()">
                </mat-progress-bar>
                <p class="progress-text">Uploading... {{ uploadProgress() }}%</p>
              </div>
            }
          </div>
        }
      </div>
    </mat-card-content>

    <mat-card-actions>
      <button 
        mat-raised-button 
        color="primary" 
        (click)="uploadFile()"
        [disabled]="!selectedFile() || uploading()"
        class="upload-btn">
        <mat-icon>upload</mat-icon>
        {{ uploading() ? 'Uploading...' : 'Upload File' }}
      </button>
    </mat-card-actions>
  </mat-card>
</div>